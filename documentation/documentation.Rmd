---
author:
  - name: Anna Michalek
    affiliation: European Central Bank
    email: \email{anna.michalek@ecb.int}
  - name: Alain Quartier-La-Tente
    affiliation: Insee
    email: \email{alain.quartier@gmail.com}
title:
  formatted: "\\pkg{RJDemetra}: A R Interface To JDemetra+ Seasonal Adjustment Software"
  # If you use tex in the formatted title, also supply version without
  plain:     "A Capitalized Title: Something about a Package foo"
  # For running headers, if needed
  short:     "\\pkg{RJDemetra}: A Capitalized Title"
abstract: >
  The abstract of the article.
keywords:
  # at least one keyword must be supplied
  formatted: ["\\proglang{R}", seasonal adjustment, time series]
  plain:     [R, seasonal adjustment, time series]
preamble: >
  \usepackage{amsmath}
  \usepackage{booktabs}
  \usepackage{longtable}
  \usepackage{array}
  \usepackage{multirow}
  \usepackage{wrapfig}
  \usepackage{float}
  \usepackage{pdflscape}
  \usepackage{tabu}
  \usepackage{threeparttable}
  \usepackage{threeparttablex}
  \usepackage[normalem]{ulem}
  \usepackage{makecell}

output: rticles::jss_article
---

# Introduction

The package \pkg{RJDemetra} provides a R interface to the seasonal adjustment software JDemetra+. Note that, JDemetra+ being implemented in Java, \pkg{RJDemetra} relies on the \pkg{rJava} package and Java SE 8 or later version is required. The two leading seasonal adjustment methods TRAMO/SEATS+ and X-12ARIMA/X-13ARIMA-SEATS can be used with all the specifications defined in JDemetra+.

## Seasonal adjustment in brief 

Mention the two SA methods and the two steps of adjustment: pre-adjustment and the decomposition. Briefly present the differences in the decomposition. 


## Using the R package RJDemetra

The \pkg{RJDemetra} package alows to:
 
* create and modify model specifications
* create and modify models
* import/export workspaces

# Estimate a predefined regarima and SA model
The package allows to estimate regarima and SA models using predefined specifications. 

```{r}
library(RJDemetra)
myseries <- ipi_c_eu[, "FR"]
mysa <- x13_def(myseries, spec=c("RSA5c"))

```

# SA object structure

```{r echo=FALSE, results='asis'}
library(knitr)
library(kableExtra)
object=c("sa_object","regarima","specification","estimate","transform","regression","userdef","specification","outliers","variables","series","description","trading.days","easter","outliers","arima","specification","coefficients","forecast","span","arma","arima.coefficients","regression.coefficients","loglik","model","spec_rslt","effects","residuals","residuals.stat","st.error","tests","forecast","decomposition","specification","mode","mstats","si_ratio","s_filter","t_filter","decomposition","specification","mode","model","model","sa","trend","seasonal","transitory","irregular","linearized","components","final","series","forecasts","diagnostics","variance_decomposition","combined_test","tests_for_stable_seasonality","combined_seasonality_test","residuals_test","user_defined")
type=c("list","list","list","data.frame","data.frame","list","list","data.frame","data.frame or NA(empty)","list","mts, ts, matrix or NA(empty)","data.frame or NA(empty)","data.frame","data.frame","data.frame","list","data.frame","data.frame or NA(empty)","data.frame","data.frame","vector - numeric","matrix","matrix","matrix","list","data.frame","mts, ts, matrix","ts","list","numeric","data.frame","mts, ts, matrix","list","data.frame","character","matrix","mts, ts, matrix","vector - character","character","list","data.frame","character","list","matrix or empty list","matrix or empty list","matrix or empty list","matrix or empty list","matrix or empty list","matrix or empty list","mts, ts, matrix","mts, ts, matrix","list","mts, ts, matrix","mts, ts, matrix","list","data.frame","list","data.frame","character","data.frame","list")
class1=c("SA, X13","regarima, X13","","","","","","","","","","","","","","","","","","","","","","","","","","","","","regarima_rtests, data.frame","","decomposition_X11","X11_spec, data.frame","","","","","","","seats_spec, data.frame","","","","","","","","","","","final","","","diagnostics","","combined_test","","","","user_defined")
class2=c("SA, TRAMO_SEATS","regarima, TRAMO_SEATS","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","decomposition_SEATS","","","","","","","","","","","","","","","","","","","","","")
level=c(0,1,2,3,3,3,4,5,5,5,6,6,4,4,3,3,4,4,3,3,2,2,2,2,2,3,3,2,2,3,3,2,1,2,2,2,2,2,2,1,2,2,2,3,3,3,3,3,3,2,2,1,2,2,1,2,2,3,3,2,1)

obj_tab <-data.frame(cbind(object,level,type,class1,class2),stringsAsFactors = FALSE)

obj_tab[obj_tab[,"level"]==1,1] <- paste0("\\hspace{1em}",obj_tab[obj_tab[,"level"]==1,1])
obj_tab[obj_tab[,"level"]==2,1] <- paste0("\\hspace{2em}",obj_tab[obj_tab[,"level"]==2,1])
obj_tab[obj_tab[,"level"]==3,1] <- paste0("\\hspace{3em}",obj_tab[obj_tab[,"level"]==3,1])
obj_tab[obj_tab[,"level"]==4,1] <- paste0("\\hspace{4em}",obj_tab[obj_tab[,"level"]==4,1])
obj_tab[obj_tab[,"level"]==5,1] <- paste0("\\hspace{5em}",obj_tab[obj_tab[,"level"]==5,1])
obj_tab[obj_tab[,"level"]==6,1] <- paste0("\\hspace{6em}",obj_tab[obj_tab[,"level"]==6,1])

obj_tab <- apply(obj_tab, 2, function(x)gsub("_","\\_",x,fixed = TRUE))
colnames(obj_tab)=c("Object","Level","Type","Class","Class")

kable(obj_tab, "latex", longtable = T,escape = FALSE, booktabs = T, caption = "SA object structure")%>%
  
  add_header_above(c(" "," "," ","x13/x13_def"," tramoseats/tramoseats_def"), italic = T)%>%
  
  add_header_above(c(" "," "," ","When adjusted with:" = 2))%>%
  
  row_spec(c(2,33,40,52,55,61), bold = T)%>% 
  
  kable_styling(font_size = 7)
  
```

## Regarima

Here we can also present the output: print and graphs.
```{r}
library(RJDemetra)
myseries <- ipi_c_eu[, "FR"]
mysa <- x13_def(myseries, spec=c("RSA5c"))
mysa$regarima
```

## Decomposition

## Final

## Diagnostics

## user defined

# Model specification: creation and modification 
The model specification can be defined from an exisitng model specification or an estimated model, as each of the estimated model contains also its specification. 

## X13

## TRAMOSEATS

## Regarima 

## Wrong specifications corrections
Parler des corrections automatiques ?
  
  
# Gestion d'un workspace
  Mise en garde sur ce que l'on ne peut pas faire (problÃ¨mes d'imports)

# Advanced usage and examples





